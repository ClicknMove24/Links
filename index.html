<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>××¢×¨×›×ª ×–×™×”×•×™ ×‘×•×˜×™× ××ª×§×“××ª - ×¢×¦×××™×ª ×œ×—×œ×•×˜×™×Ÿ</title>
    
    <style>
        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            color: white;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            text-align: center;
            padding: 40px 20px;
        }
        
        h1 {
            font-size: 2.5em;
            margin-bottom: 20px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        
        .card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 30px;
            margin: 20px 0;
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
            box-shadow: 0 8px 32px rgba(0,0,0,0.1);
        }
        
        .visitor-info {
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: right;
        }
        
        .visitor-info h3 {
            margin-top: 0;
            color: #ffd700;
            text-align: center;
            margin-bottom: 15px;
        }
        
        .info-row {
            display: flex;
            justify-content: space-between;
            margin: 10px 0;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .info-label {
            font-weight: bold;
            color: #ffd700;
        }
        
        .info-value {
            color: #e0e0e0;
            max-width: 60%;
            word-break: break-word;
        }
        
        .advanced-detection {
            background: rgba(255,255,255,0.15);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: center;
        }
        
        .detection-score {
            font-size: 1.8em;
            font-weight: bold;
            margin: 15px 0;
        }
        
        .confidence-bar {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            height: 20px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .confidence-fill {
            height: 100%;
            transition: width 0.5s ease;
        }
        
        .high-confidence { background: linear-gradient(90deg, #4CAF50, #81C784); }
        .medium-confidence { background: linear-gradient(90deg, #ff9800, #ffb74d); }
        .low-confidence { background: linear-gradient(90deg, #f44336, #ef5350); }
        
        .bot-indicator {
            font-size: 1.3em;
            font-weight: bold;
            padding: 15px;
            border-radius: 10px;
            margin: 15px 0;
        }
        
        .human {
            background: rgba(0, 255, 0, 0.2);
            border: 2px solid #00ff00;
        }
        
        .suspicious {
            background: rgba(255, 165, 0, 0.2);
            border: 2px solid #ffa500;
        }
        
        .bot {
            background: rgba(255, 0, 0, 0.2);
            border: 2px solid #ff0000;
        }
        
        .analytics-section {
            text-align: right;
            font-size: 0.9em;
            color: #b8d4f0;
            margin: 10px 0;
        }
        
        .real-time-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
            gap: 15px;
            margin: 20px 0;
        }
        
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            text-align: center;
        }
        
        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #ffd700;
        }
        
        .stat-label {
            font-size: 0.9em;
            margin-top: 5px;
            color: #e0e0e0;
        }
        
        .button {
            background: linear-gradient(45deg, #ff6b6b, #ff8e8e);
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 25px;
            font-size: 16px;
            cursor: pointer;
            margin: 10px;
            transition: transform 0.3s ease;
        }
        
        .button:hover {
            transform: scale(1.05);
        }
        
        .source-analysis {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            text-align: right;
        }
        
        .source-item {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .source-name {
            font-weight: bold;
            color: #ffd700;
        }
        
        .source-count {
            color: #4CAF50;
        }
        
        .session-timeline {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .timeline-item {
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 10px;
            margin: 5px 0;
            font-size: 0.9em;
            text-align: right;
        }
        
        .timeline-time {
            color: #ffd700;
            font-weight: bold;
        }
        
        .warning {
            background: rgba(255, 152, 0, 0.2);
            border: 2px solid #ff9800;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
            color: #fff;
        }
        
        @media (max-width: 768px) {
            .dashboard-grid {
                grid-template-columns: 1fr;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .real-time-stats {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ›¡ï¸ ××¢×¨×›×ª ×–×™×”×•×™ ×‘×•×˜×™× ××ª×§×“××ª</h1>
        <p style="font-size: 1.1em; margin-bottom: 20px; color: #b8d4f0;">
            ××¢×¨×›×ª ×–×™×”×•×™ ×¢×¦×××™×ª ×•××ª×§×“××ª - ×œ×œ× ×ª×œ×•×ª ×‘×¡×¤×¨×™×•×ª ×—×™×¦×•× ×™×•×ª
        </p>
        
        <div class="dashboard-grid">
            <!-- ××™×“×¢ ×¢×œ ×”××‘×§×¨ -->
            <div class="card">
                <div class="visitor-info">
                    <h3>ğŸ•µï¸ ××™×“×¢ ××‘×§×¨ × ×•×›×—×™</h3>
                    <div class="info-row">
                        <span class="info-label">×–××Ÿ ×›× ×™×¡×”:</span>
                        <span class="info-value" id="visit-time"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">××–×”×” ××‘×§×¨:</span>
                        <span class="info-value" id="visitor-id">×™×•×¦×¨...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">××–×”×” ×¡×©×Ÿ:</span>
                        <span class="info-value" id="session-id"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">×˜×‘×™×¢×ª ××¦×‘×¢:</span>
                        <span class="info-value" id="device-fingerprint">×™×•×¦×¨...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">×“×¤×“×¤×Ÿ:</span>
                        <span class="info-value" id="browser-info">××–×”×”...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">××§×•×¨ ×”×’×¢×”:</span>
                        <span class="info-value" id="referrer-info">×‘×•×“×§...</span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">×’×•×“×œ ××¡×š:</span>
                        <span class="info-value" id="screen-size"></span>
                    </div>
                    <div class="info-row">
                        <span class="info-label">×–××Ÿ ×¢×œ ×”×“×£:</span>
                        <span class="info-value" id="time-on-page">0 ×©× ×™×•×ª</span>
                    </div>
                </div>
            </div>
            
            <!-- ×–×™×”×•×™ ×‘×•×˜×™× ××ª×§×“× -->
            <div class="card">
                <div class="advanced-detection">
                    <h3 style="color: #ffd700; margin-bottom: 15px;">ğŸ¤– ×ª×•×¦××•×ª ×–×™×”×•×™</h3>
                    
                    <div id="bot-detection" class="bot-indicator">
                        ğŸ” ××¨×™×¥ ×‘×“×™×§×•×ª ××ª×§×“××•×ª...
                    </div>
                    
                    <div class="detection-score">
                        <span>×¨××ª ×××™× ×•×ª: </span>
                        <span id="confidence-score" style="color: #4CAF50;">×—×•×©×‘...</span>
                    </div>
                    
                    <div class="confidence-bar">
                        <div id="confidence-fill" class="confidence-fill high-confidence" style="width: 0%"></div>
                    </div>
                    
                    <div id="advanced-results">
                        <div class="analytics-section">ğŸ”¬ ××¨×™×¥ ×‘×“×™×§×•×ª ××ª×§×“××•×ª...</div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ×¡×˜×˜×™×¡×˜×™×§×•×ª ×–××Ÿ ×××ª -->
        <div class="card">
            <h3 style="color: #ffd700; margin-bottom: 20px;">ğŸ“Š ×¡×˜×˜×™×¡×˜×™×§×•×ª ×–××Ÿ ×××ª</h3>
            <div class="real-time-stats">
                <div class="stat-card">
                    <div class="stat-number" id="total-visitors">1</div>
                    <div class="stat-label">××‘×§×¨×™× ×‘×¡×©×Ÿ</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="bot-detections">0</div>
                    <div class="stat-label">×‘×•×˜×™× ×–×•×”×•</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="suspicious-activities">0</div>
                    <div class="stat-label">×¤×¢×™×œ×•×™×•×ª ×—×©×•×“×•×ª</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="button-clicks">0</div>
                    <div class="stat-label">×œ×—×™×¦×•×ª ×›×¤×ª×•×¨×™×</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="mouse-movements">0</div>
                    <div class="stat-label">×ª× ×•×¢×•×ª ×¢×›×‘×¨</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="page-interactions">0</div>
                    <div class="stat-label">××™× ×˜×¨××§×¦×™×•×ª</div>
                </div>
            </div>
        </div>
        
        <div class="dashboard-grid">
            <!-- × ×™×ª×•×— ××§×•×¨×•×ª -->
            <div class="card">
                <h3 style="color: #ffd700; margin-bottom: 15px;">ğŸŒ × ×™×ª×•×— ××§×•×¨×•×ª ×ª× ×•×¢×”</h3>
                <div class="source-analysis" id="source-analysis">
                    <div class="source-item">
                        <span class="source-name">×˜×•×¢×Ÿ × ×ª×•× ×™×...</span>
                        <span class="source-count">-</span>
                    </div>
                </div>
            </div>
            
            <!-- ×¦×™×¨ ×–××Ÿ ×©×œ ×”×¡×©×Ÿ -->
            <div class="card">
                <h3 style="color: #ffd700; margin-bottom: 15px;">â±ï¸ ×¦×™×¨ ×–××Ÿ ×”×¡×©×Ÿ</h3>
                <div class="session-timeline" id="session-timeline">
                    <div class="timeline-item">
                        <span class="timeline-time">×”×ª×—×œ×ª ×¡×©×Ÿ</span> - ××¢×¨×›×ª ××ª×—×™×œ×”
                    </div>
                </div>
            </div>
        </div>
        
        <!-- ×¤×¨××˜×¨×™ UTM -->
        <div class="card">
            <h3 style="color: #ffd700; margin-bottom: 15px;">ğŸ”— ×¤×¨××˜×¨×™ ××¢×§×‘ (UTM)</h3>
            <div id="utm-params" style="text-align: right; font-family: monospace; background: rgba(0,0,0,0.2); padding: 15px; border-radius: 8px;"></div>
        </div>
        
        <!-- ×‘×“×™×§×•×ª ××™× ×˜×¨××§×¦×™×” -->
        <div class="card">
            <h3 style="color: #ffd700; margin-bottom: 15px;">ğŸ”¬ ×‘×“×™×§×•×ª ××™× ×˜×¨××§×¦×™×”</h3>
            <button class="button" onclick="trackButtonClick('test_button_1')">ğŸ–±ï¸ ×‘×“×™×§×ª ×œ×—×™×¦×”</button>
            <button class="button" onclick="trackMouseMovement()">ğŸ­ ××¢×§×‘ ×¢×›×‘×¨</button>
            <button class="button" onclick="trackScrollBehavior()">ğŸ“œ ×‘×“×™×§×ª ×’×œ×™×œ×”</button>
            <button class="button" onclick="startAdvancedBehaviorTest()">ğŸ§ª ×‘×“×™×§×” ××ª×§×“××ª</button>
        </div>
        
        <!-- × ×™×”×•×œ × ×ª×•× ×™× -->
        <div class="card">
            <h3 style="color: #ffd700; margin-bottom: 15px;">ğŸ“ × ×™×”×•×œ × ×ª×•× ×™×</h3>
            <button class="button" onclick="downloadReport()" style="background: linear-gradient(45deg, #4CAF50, #66BB6A);">ğŸ“¥ ×”×•×¨×“ ×“×•×— JSON</button>
            <button class="button" onclick="downloadCSVReport()" style="background: linear-gradient(45deg, #2196F3, #42A5F5);">ğŸ“Š ×”×•×¨×“ ×“×•×— CSV</button>
            <button class="button" onclick="clearAllData()" style="background: linear-gradient(45deg, #f44336, #ef5350);">ğŸ—‘ï¸ × ×§×” × ×ª×•× ×™×</button>
            <button class="button" onclick="showDataSummary()" style="background: linear-gradient(45deg, #FF9800, #FFB74D);">ğŸ“‹ ×¡×™×›×•× × ×ª×•× ×™×</button>
        </div>
        
        <!-- ××–×”×¨×•×ª -->
        <div id="warnings-container"></div>
    </div>

    <script>
        // ××©×ª× ×™× ×’×œ×•×‘×œ×™×™×
        let sessionId = generateSessionId();
        let visitorId = getOrCreateVisitorId();
        let deviceFingerprint = null;
        let analyticsData = [];
        let realTimeStats = {
            totalVisitors: 1,
            botDetections: 0,
            suspiciousActivities: 0,
            buttonClicks: 0,
            mouseMovements: 0,
            pageInteractions: 0
        };
        let behaviorAnalysis = {
            mouseMovements: [],
            clicks: [],
            scrollEvents: [],
            keystrokes: []
        };
        let sourceTracking = {};
        let sessionTimeline = [];
        let startTime = Date.now();
        
        // ×™×¦×™×¨×ª ××–×”×” ×¡×©×Ÿ ×™×™×—×•×“×™
        function generateSessionId() {
            return 'sess_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
        }
        
        // ×§×‘×œ×ª ××• ×™×¦×™×¨×ª ××–×”×” ××‘×§×¨
        function getOrCreateVisitorId() {
            let vid = localStorage.getItem('visitor_id');
            if (!vid) {
                vid = 'visitor_' + Date.now() + '_' + Math.random().toString(36).substr(2, 9);
                localStorage.setItem('visitor_id', vid);
            }
            return vid;
        }
        
        // ×™×¦×™×¨×ª ×˜×‘×™×¢×ª ××¦×‘×¢ ×¢×¦×××™×ª
        function createDeviceFingerprint() {
            const canvas = document.createElement('canvas');
            const ctx = canvas.getContext('2d');
            ctx.textBaseline = 'top';
            ctx.font = '14px Arial';
            ctx.fillText('ğŸ¤– Bot Detection Test', 2, 2);
            
            const fingerprint = [
                navigator.userAgent,
                navigator.language,
                screen.width + 'x' + screen.height,
                screen.colorDepth,
                new Date().getTimezoneOffset(),
                navigator.platform,
                navigator.cookieEnabled,
                typeof(Worker),
                canvas.toDataURL()
            ].join('|');
            
            // ×™×¦×™×¨×ª hash ×¤×©×•×˜
            let hash = 0;
            for (let i = 0; i < fingerprint.length; i++) {
                const char = fingerprint.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32-bit integer
            }
            
            return 'fp_' + Math.abs(hash).toString(36);
        }
        
        // ××¢×¨×›×ª Analytics ××•×ª×××ª - ×¢×¦×××™×ª ×œ×—×œ×•×˜×™×Ÿ
        function logAnalyticsEvent(eventType, data) {
            const event = {
                type: eventType,
                timestamp: Date.now(),
                session_id: sessionId,
                visitor_id: visitorId,
                url: window.location.href,
                referrer: document.referrer,
                user_agent: navigator.userAgent,
                screen_resolution: screen.width + 'x' + screen.height,
                device_fingerprint: deviceFingerprint,
                ...data
            };
            
            // ×©××™×¨×” ×‘-localStorage
            analyticsData.push(event);
            if (analyticsData.length > 1000) {
                analyticsData.shift();
            }
            localStorage.setItem('custom_analytics', JSON.stringify(analyticsData));
            
            // ×¢×“×›×•×Ÿ ×¦×™×¨ ×”×–××Ÿ
            addToTimeline(eventType, data);
            
            // ×¢×™×‘×•×“ × ×ª×•× ×™×
            processAnalyticsData(event);
            
            console.log('ğŸ“Š Analytics Event:', event);
        }
        
        // ×”×•×¡×¤×” ×œ×¦×™×¨ ×”×–××Ÿ
        function addToTimeline(eventType, data) {
            const time = new Date().toLocaleTimeString('he-IL');
            let description = '';
            
            switch(eventType) {
                case 'page_view':
                    description = '×›× ×™×¡×” ×œ×“×£';
                    break;
                case 'button_click':
                    description = `×œ×—×™×¦×” ×¢×œ ×›×¤×ª×•×¨: ${data.button_name}`;
                    realTimeStats.pageInteractions++;
                    break;
                case 'mouse_movement':
                    description = `×ª× ×•×¢×ª ×¢×›×‘×¨ (${data.move_count})`;
                    if (data.move_count % 50 === 0) {
                        realTimeStats.mouseMovements += 50;
                    }
                    break;
                case 'suspicious_behavior':
                    description = `×”×ª× ×”×’×•×ª ×—×©×•×“×”: ${data.patterns}`;
                    realTimeStats.suspiciousActivities++;
                    break;
                case 'bot_detection':
                    if (data.bot_score > 50) {
                        description = `×–×•×”×” ×‘×•×˜ (×¦×™×•×Ÿ: ${data.bot_score})`;
                        realTimeStats.botDetections++;
                    } else {
                        description = `×–×•×”×” ××©×ª××© ×××™×ª×™ (×¦×™×•×Ÿ: ${data.bot_score})`;
                    }
                    break;
                default:
                    description = eventType;
            }
            
            sessionTimeline.push({
                time: time,
                event: eventType,
                description: description,
                timestamp: Date.now()
            });
            
            if (sessionTimeline.length > 20) {
                sessionTimeline.shift();
            }
            
            updateTimelineDisplay();
            updateRealTimeStatsDisplay();
        }
        
        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×¦×™×¨ ×”×–××Ÿ
        function updateTimelineDisplay() {
            const timelineElement = document.getElementById('session-timeline');
            timelineElement.innerHTML = '';
            
            sessionTimeline.slice().reverse().forEach(item => {
                const div = document.createElement('div');
                div.className = 'timeline-item';
                div.innerHTML = `<span class="timeline-time">${item.time}</span> - ${item.description}`;
                timelineElement.appendChild(div);
            });
        }
        
        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ×¡×˜×˜×™×¡×˜×™×§×•×ª
        function updateRealTimeStatsDisplay() {
            Object.keys(realTimeStats).forEach(key => {
                const elementId = key.replace(/([A-Z])/g, '-$1').toLowerCase();
                const element = document.getElementById(elementId);
                if (element) {
                    element.textContent = realTimeStats[key];
                }
            });
        }
        
        // ×¢×™×‘×•×“ × ×ª×•× ×™×
        function processAnalyticsData(event) {
            analyzeTrafficSources(event);
            detectSuspiciousPatterns();
        }
        
        // × ×™×ª×•×— ××§×•×¨×•×ª ×ª× ×•×¢×”
        function analyzeTrafficSources(event) {
            let source = 'direct';
            
            if (event.referrer) {
                try {
                    const referrerDomain = new URL(event.referrer).hostname;
                    if (referrerDomain.includes('google')) source = 'google';
                    else if (referrerDomain.includes('facebook')) source = 'facebook';
                    else if (referrerDomain.includes('instagram')) source = 'instagram';
                    else if (referrerDomain.includes('twitter')) source = 'twitter';
                    else if (referrerDomain.includes('linkedin')) source = 'linkedin';
                    else if (referrerDomain.includes('whatsapp')) source = 'whatsapp';
                    else if (referrerDomain.includes('telegram')) source = 'telegram';
                    else source = referrerDomain;
                } catch (e) {
                    source = 'unknown';
                }
            }
            
            const utmSource = new URLSearchParams(window.location.search).get('utm_source');
            if (utmSource) {
                source = utmSource;
            }
            
            if (!sourceTracking[source]) {
                sourceTracking[source] = 0;
            }
            sourceTracking[source]++;
            
            updateSourceDisplay();
        }
        
        // ×¢×“×›×•×Ÿ ×ª×¦×•×’×ª ××§×•×¨×•×ª
        function updateSourceDisplay() {
            const sourceElement = document.getElementById('source-analysis');
            sourceElement.innerHTML = '';
            
            Object.entries(sourceTracking)
                .sort((a, b) => b[1] - a[1])
                .forEach(([source, count]) => {
                    const div = document.createElement('div');
                    div.className = 'source-item';
                    div.innerHTML = `
                        <span class="source-name">${getSourceDisplayName(source)}</span>
                        <span class="source-count">${count}</span>
                    `;
                    sourceElement.appendChild(div);
                });
        }
        
        // ×©××•×ª ×ª×¦×•×’×” ×œ××§×•×¨×•×ª
        function getSourceDisplayName(source) {
            const names = {
                'direct': 'ğŸ”— ×’×™×©×” ×™×©×™×¨×”',
                'google': 'ğŸ” ×’×•×’×œ',
                'facebook': 'ğŸ“˜ ×¤×™×™×¡×‘×•×§',
                'instagram': 'ğŸ“· ××™× ×¡×˜×’×¨×',
                'twitter': 'ğŸ¦ ×˜×•×•×™×˜×¨',
                'linkedin': 'ğŸ’¼ ×œ×™× ×§×“××™×Ÿ',
                'whatsapp': 'ğŸ’¬ ×•×•×˜×¡××¤',
                'telegram': 'âœˆï¸ ×˜×œ×’×¨×',
                'unknown': 'â“ ×œ× ×™×“×•×¢'
            };
            return names[source] || `ğŸŒ ${source}`;
        }
        
        // ×–×™×”×•×™ ×“×¤×•×¡×™× ×—×©×•×“×™×
        function detectSuspiciousPatterns() {
            const recentEvents = analyticsData.filter(e => Date.now() - e.timestamp < 60000);
            const warnings = [];
            
            const clicks = recentEvents.filter(e => e.type === 'button_click');
            if (clicks.length > 10) {
                warnings.push('ğŸš¨ ×™×•×ª×¨ ××“×™ ×œ×—×™×¦×•×ª ×‘×“×§×” ××—×¨×•× ×”');
            }
            
            const interactions = recentEvents.filter(e => 
                ['button_click', 'mouse_movement', 'scroll_behavior'].includes(e.type)
            );
            if (recentEvents.length > 5 && interactions.length === 0) {
                warnings.push('âš ï¸ ×¤×¢×™×œ×•×ª ×œ×œ× ××™× ×˜×¨××§×¦×™×•×ª ××©×ª××©');
            }
            
            displayWarnings(warnings);
        }
        
        // ×”×¦×’×ª ××–×”×¨×•×ª
        function displayWarnings(warnings) {
            const warningsContainer = document.getElementById('warnings-container');
            warningsContainer.innerHTML = '';
            
            warnings.forEach(warning => {
                const div = document.createElement('div');
                div.className = 'warning';
                div.textContent = warning;
                warningsContainer.appendChild(div);
            });
        }
        
        // ×–×™×”×•×™ ×‘×•×˜×™× ×¢×¦×××™ ×•××ª×§×“×
        function detectAdvancedBot() {
            let botScore = 0;
            let confidence = 100;
            let reasons = [];
            let detectionMethods = [];
            
            // 1. × ×™×ª×•×— User Agent ××ª×§×“×
            const ua = navigator.userAgent;
            const botKeywords = [
                'bot', 'crawler', 'spider', 'scraper', 'headless', 'phantom',
                'selenium', 'webdriver', 'automation', 'puppeteer', 'playwright',
                'googlebot', 'bingbot', 'slurp', 'duckduckbot', 'baiduspider'
            ];
            
            const foundBotKeywords = botKeywords.filter(keyword => ua.toLowerCase().includes(keyword));
            if (foundBotKeywords.length > 0) {
                botScore += 60;
                reasons.push(`ğŸ•µï¸ User Agent ×—×©×•×“: ${foundBotKeywords.join(', ')}`);
                detectionMethods.push('UA Analysis');
            }
            
            // 2. ×‘×“×™×§×ª WebDriver
            if (navigator.webdriver) {
                botScore += 50;
                reasons.push('ğŸš— WebDriver ×–×•×”×”');
                detectionMethods.push('WebDriver Detection');
            }
            
            // 3. ×‘×“×™×§×ª window properties ×—×©×•×“×™×
            const suspiciousProps = ['webdriver', '_phantom', 'callPhantom', '_selenium', 'selenium', 'domAutomation'];
            suspiciousProps.forEach(prop => {
                if (window[prop]) {
                    botScore += 20;
                    reasons.push(`âš ï¸ × ××¦× ${prop}`);
                    detectionMethods.push('Environment Check');
                }
            });
            
            // 4. ×‘×“×™×§×ª plugins
            if (navigator.plugins.length === 0) {
                botScore += 15;
                reasons.push('ğŸ”Œ ××™×Ÿ plugins ×‘×“×¤×“×¤×Ÿ');
                detectionMethods.push('Plugin Check');
            }
            
            // 5. ×‘×“×™×§×ª languages
            if (!navigator.languages || navigator.languages.length === 0) {
                botScore += 10;
                reasons.push('ğŸŒ ×—×¡×¨ ××™×“×¢ ×©×¤×•×ª');
                detectionMethods.push('Language Check');
            }
            
            // 6. ×‘×“×™×§×ª ×¨×–×•×œ×•×¦×™×”
            if (screen.width === 0 || screen.height === 0) {
                botScore += 25;
                reasons.push('ğŸ“º ×¨×–×•×œ×•×¦×™×™×ª ××¡×š ×œ× ×ª×§×™× ×”');
                detectionMethods.push('Screen Check');
            }
            
            // 7. ×‘×“×™×§×ª timezone
            const timezone = Intl.DateTimeFormat().resolvedOptions().timeZone;
            if (!timezone || timezone === 'UTC') {
                botScore += 10;
                reasons.push('ğŸŒ ××–×•×¨ ×–××Ÿ ×—×©×•×“');
                detectionMethods.push('Timezone Check');
            }
            
            // 8. ×‘×“×™×§×ª Canvas
            try {
                const canvas = document.createElement('canvas');
                const ctx = canvas.getContext('2d');
                ctx.textBaseline = 'top';
                ctx.font = '14px Arial';
                ctx.fillText('Bot Detection Test ğŸ¤–', 2, 2);
                const canvasData = canvas.toDataURL();
                
                if (canvasData.length < 100) {
                    botScore += 30;
                    reasons.push('ğŸ–¼ï¸ Canvas ×¨×™×§ ××• ×—×¡×•×');
                    detectionMethods.push('Canvas Check');
                }
            } catch (e) {
                botScore += 25;
                reasons.push('ğŸ–¼ï¸ ×©×’×™××” ×‘-Canvas');
                detectionMethods.push('Canvas Error');
            }
            
            // 9. ×‘×“×™×§×ª WebGL
            try {
                const canvas = document.createElement('canvas');
                const gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
                if (!gl) {
                    botScore += 15;
                    reasons.push('ğŸ® ××™×Ÿ ×ª××™×›×” ×‘-WebGL');
                    detectionMethods.push('WebGL Check');
                }
            } catch (e) {
                botScore += 10;
                reasons.push('ğŸ® ×©×’×™××” ×‘-WebGL');
                detectionMethods.push('WebGL Error');
            }
            
            // 10. ×‘×“×™×§×ª ×–×× ×™ ×˜×¢×™× ×”
            if (performance && performance.timing) {
                const loadTime = performance.timing.loadEventEnd - performance.timing.navigationStart;
                if (loadTime < 100) {
                    botScore += 20;
                    reasons.push(`âš¡ ×˜×¢×™× ×” ××”×™×¨×” ×—×¨×™×’×”: ${loadTime}ms`);
                    detectionMethods.push('Timing Analysis');
                }
            }
            
            // ×—×™×©×•×‘ ×¦×™×•×Ÿ ×¡×•×¤×™ ×•×¨××ª ×‘×™×˜×—×•×Ÿ
            botScore = Math.min(botScore, 100);
            
            if (botScore >= 70) {
                confidence = 95;
            } else if (botScore >= 40) {
                confidence = 75;
            } else if (botScore >= 20) {
                confidence = 60;
            } else {
                confidence = 90;
            }
            
            // ×¢×“×›×•×Ÿ ×××©×§ ×”××©×ª××©
            updateBotDetectionUI(botScore, confidence, reasons, detectionMethods);
            
            // ×©×œ×™×—×” ×œ××¢×¨×›×ª Analytics
            logAnalyticsEvent('bot_detection', {
                'bot_score': botScore,
                'confidence': confidence,
                'detection_methods': detectionMethods.join(','),
                'reasons': reasons.join(';')
            });
        }
        
        // ×¢×“×›×•×Ÿ ×××©×§ ×–×™×”×•×™ ×‘×•×˜×™×
        function updateBotDetectionUI(botScore, confidence, reasons, methods) {
            const confidenceElement = document.getElementById('confidence-score');
            const confidenceFill = document.getElementById('confidence-fill');
            const resultsElement = document.getElementById('advanced-results');
            const detectionElement = document.getElementById('bot-detection');
            
            confidenceElement.textContent = `${confidence}%`;
            confidenceFill.style.width = `${confidence}%`;
            
            // ×¦×‘×¢×™× ×œ×¤×™ ×¦×™×•×Ÿ
            if (botScore >= 70) {
                confidenceElement.style.color = '#f44336';
                confidenceFill.className = 'confidence-fill low-confidence';
                detectionElement.className = 'bot-indicator bot';
                detectionElement.innerHTML = `ğŸ¤– ×–×•×”×” ×›×‘×•×˜ (×¦×™×•×Ÿ: ${botScore}/100)`;
            } else if (botScore >= 40) {
                confidenceElement.style.color = '#ff9800';
                confidenceFill.className = 'confidence-fill medium-confidence';
                detectionElement.className = 'bot-indicator suspicious';
                detectionElement.innerHTML = `âš ï¸ ×”×ª× ×”×’×•×ª ×—×©×•×“×” (×¦×™×•×Ÿ: ${botScore}/100)`;
            } else {
                confidenceElement.style.color = '#4CAF50';
                confidenceFill.className = 'confidence-fill high-confidence';
                detectionElement.className = 'bot-indicator human';
                detectionElement.innerHTML = `ğŸ‘¤ ××©×ª××© ×××™×ª×™ (×¦×™×•×Ÿ: ${botScore}/100)`;
            }
            
            // ×ª×•×¦××•×ª ××¤×•×¨×˜×•×ª
            let resultsHTML = `
                <div class="analytics-section">ğŸ“Š × ×™×§×•×“ ×‘×•×˜: <strong>${botScore}/100</strong></div>
                <div class="analytics-section">ğŸ”¬ ×©×™×˜×•×ª ×–×™×”×•×™: ${methods.join(', ')}</div>
                <div class="analytics-section">ğŸ†” ××–×”×” ××›×©×™×¨: ${deviceFingerprint}</div>
                <div class="analytics-section">ğŸ• ×–××Ÿ ×–×™×”×•×™: ${new Date().toLocaleTimeString('he-IL')}</div>
            `;
            
            if (reasons.length > 0) {
                resultsHTML += '<div style="margin-top: 15px; text-align: right;"><strong>ğŸ” ×¡×™×‘×•×ª ×œ×—×©×“:</strong></div>';
                reasons.forEach(reason => {
                    resultsHTML += `<div class="analytics-section">${reason}</div>`;
                });
            }
            
            resultsElement.innerHTML = resultsHTML;
        }
        
        // ×§×¨×™××ª ×¤×¨××˜×¨×™ UTM
        function parseUTMParams() {
            const urlParams = new URLSearchParams(window.location.search);
            const utmParams = {};
            
            ['utm_source', 'utm_medium', 'utm_campaign', 'utm_term', 'utm_content'].forEach(param => {
                if (urlParams.has(param)) {
                    utmParams[param] = urlParams.get(param);
                }
            });
            
            const utmElement = document.getElementById('utm-params');
            if (Object.keys(utmParams).length > 0) {
                utmElement.innerHTML = Object.entries(utmParams)
                    .map(([key, value]) => `<strong style="color: #ffd700;">${key}:</strong> ${value}`)
                    .join('<br>');
            } else {
                utmElement.innerHTML = '<span style="color: #ff9800;">âŒ ×œ× ×”×ª×§×‘×œ×• ×¤×¨××˜×¨×™ UTM</span>';
            }
            
            return utmParams;
        }
        
        // × ×™×ª×•×— ××§×•×¨ ×”×’×¢×”
        function analyzeReferrer() {
            const referrer = document.referrer;
            let referrerInfo = '×’×™×©×” ×™×©×™×¨×”';
            
            if (referrer) {
                try {
                    const url = new URL(referrer);
                    referrerInfo = url.hostname;
                } catch (e) {
                    referrerInfo = '××§×•×¨ ×œ× ×™×“×•×¢';
                }
            }
            
            document.getElementById('referrer-info').textContent = referrerInfo;
            return referrerInfo;
        }
        
        // ×–×™×”×•×™ ×“×¤×“×¤×Ÿ ×‘×¡×™×¡×™
        function detectBrowser() {
            const ua = navigator.userAgent;
            let browser = '×œ× ×™×“×•×¢';
            
            if (ua.includes('Edg/')) browser = 'Microsoft Edge';
            else if (ua.includes('Chrome/') && !ua.includes('Edg/')) browser = 'Google Chrome';
            else if (ua.includes('Firefox/')) browser = 'Mozilla Firefox';
            else if (ua.includes('Safari/') && !ua.includes('Chrome/')) browser = 'Safari';
            else if (ua.includes('Opera/') || ua.includes('OPR/')) browser = 'Opera';
            
            document.getElementById('browser-info').textContent = browser;
        }
        
        // ×¤×•× ×§×¦×™×•×ª ××™× ×˜×¨××§×¦×™×”
        function trackButtonClick(buttonName) {
            logAnalyticsEvent('button_click', {
                'button_name': buttonName,
                'page_url': window.location.href
            });
            
            realTimeStats.buttonClicks++;
            updateRealTimeStatsDisplay();
            alert('×œ×—×™×¦×” × ×¨×©××” ×‘××¢×¨×›×ª Analytics ×”××•×ª×××ª ×©×œ× ×•!');
        }
        
        function trackMouseMovement() {
            let mouseMoveCount = 0;
            const handler = (e) => {
                mouseMoveCount++;
                if (mouseMoveCount % 10 === 0) {
                    logAnalyticsEvent('mouse_movement', {
                        'move_count': mouseMoveCount,
                        'x': e.clientX,
                        'y': e.clientY
                    });
                }
            };
            
            document.addEventListener('mousemove', handler);
            alert('××¢×§×‘ ××—×¨×™ ×”×¢×›×‘×¨ ×”×•×¤×¢×œ! ×–×•×– ××ª ×”×¢×›×‘×¨ ×•×¨××” ×©×–×” × ×¨×©× ×‘××¢×¨×›×ª ×©×œ× ×•');
            
            setTimeout(() => {
                document.removeEventListener('mousemove', handler);
                alert(`× ×¨×©××• ${mouseMoveCount} ×ª× ×•×¢×•×ª ×¢×›×‘×¨ ×‘××¢×¨×›×ª Analytics ×”××•×ª×××ª`);
            }, 10000);
        }
        
        function trackScrollBehavior() {
            let scrollCount = 0;
            const handler = () => {
                scrollCount++;
                if (scrollCount % 5 === 0) {
                    logAnalyticsEvent('scroll_behavior', {
                        'scroll_count': scrollCount,
                        'scroll_position': window.pageYOffset
                    });
                }
            };
            
            window.addEventListener('scroll', handler);
            alert('××¢×§×‘ ××—×¨×™ ×”×’×œ×™×œ×” ×”×•×¤×¢×œ! ×ª×’×œ×•×œ ×›×“×™ ×œ×¨××•×ª ×©×–×” × ×¨×©×');
            
            setTimeout(() => {
                window.removeEventListener('scroll', handler);
                alert(`× ×¨×©××• ${scrollCount} ×’×œ×™×œ×•×ª ×‘××¢×¨×›×ª ×©×œ× ×•`);
            }, 10000);
        }
        
        function startAdvancedBehaviorTest() {
            alert('ğŸ§ª ×‘×“×™×§×” ××ª×§×“××ª ×”×—×œ×”! ×‘×¦×¢ ×¤×¢×•×œ×•×ª ×©×•× ×•×ª ×‘××©×š 10 ×©× ×™×•×ª ×”×‘××•×ª');
            
            let testData = { mouseEvents: 0, clickEvents: 0, scrollEvents: 0 };
            
            const mouseHandler = () => testData.mouseEvents++;
            const clickHandler = () => testData.clickEvents++;
            const scrollHandler = () => testData.scrollEvents++;
            
            document.addEventListener('mousemove', mouseHandler);
            document.addEventListener('click', clickHandler);
            document.addEventListener('scroll', scrollHandler);
            
            setTimeout(() => {
                document.removeEventListener('mousemove', mouseHandler);
                document.removeEventListener('click', clickHandler);
                document.removeEventListener('scroll', scrollHandler);
                
                let suspiciousScore = 0;
                let findings = [];
                
                if (testData.mouseEvents === 0) {
                    suspiciousScore += 50;
                    findings.push('××™×Ÿ ×ª× ×•×¢×ª ×¢×›×‘×¨');
                }
                
                if (testData.clickEvents > 10) {
                    suspiciousScore += 30;
                    findings.push('×™×•×ª×¨ ××“×™ ×œ×—×™×¦×•×ª');
                }
                
                logAnalyticsEvent('advanced_behavior_test', {
                    'suspicious_score': suspiciousScore,
                    'findings': findings.join(';'),
                    'mouse_events': testData.mouseEvents,
                    'click_events': testData.clickEvents,
                    'scroll_events': testData.scrollEvents
                });
                
                alert(`×ª×•×¦××•×ª ×”×‘×“×™×§×” ×”××ª×§×“××ª:\n×¦×™×•×Ÿ ×—×©×“× ×•×ª: ${suspiciousScore}/100\n×ª× ×•×¢×•×ª ×¢×›×‘×¨: ${testData.mouseEvents}\n×œ×—×™×¦×•×ª: ${testData.clickEvents}\n×’×œ×™×œ×•×ª: ${testData.scrollEvents}`);
            }, 10000);
        }
        
        // ×¤×•× ×§×¦×™×•×ª ×”×•×¨×“×ª ×“×•×—×•×ª
        function downloadReport() {
            const data = localStorage.getItem('custom_analytics');
            const analyticsData = data ? JSON.parse(data) : [];
            
            const report = {
                generated_at: new Date().toISOString(),
                generated_by: visitorId,
                total_events: analyticsData.length,
                summary: {
                    page_views: analyticsData.filter(e => e.type === 'page_view').length,
                    button_clicks: analyticsData.filter(e => e.type === 'button_click').length,
                    bot_detections: analyticsData.filter(e => e.type === 'bot_detection').length,
                    suspicious_behaviors: analyticsData.filter(e => e.type === 'suspicious_behavior').length,
                    unique_sessions: [...new Set(analyticsData.map(e => e.session_id))].length,
                    unique_visitors: [...new Set(analyticsData.map(e => e.visitor_id))].length
                },
                events: analyticsData
            };
            
            const blob = new Blob([JSON.stringify(report, null, 2)], {
                type: 'application/json;charset=utf-8'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bot_detection_report_${new Date().toISOString().split('T')[0]}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('ğŸ“¥ ×“×•×— JSON ×”×•×¨×“ ×‘×”×¦×œ×—×”!');
        }
        
        function downloadCSVReport() {
            const data = localStorage.getItem('custom_analytics');
            const analyticsData = data ? JSON.parse(data) : [];
            
            if (analyticsData.length === 0) {
                alert('âŒ ××™×Ÿ × ×ª×•× ×™× ×œ×”×•×¨×“×”');
                return;
            }
            
            const headers = ['×–××Ÿ', '×¡×•×’ ××™×¨×•×¢', '××–×”×” ××‘×§×¨', '××–×”×” ×¡×©×Ÿ', '××§×•×¨', 'URL', '×¦×™×•×Ÿ ×‘×•×˜'];
            
            const csvRows = [
                headers.join(','),
                ...analyticsData.map(event => [
                    new Date(event.timestamp).toLocaleString('he-IL'),
                    event.type,
                    event.visitor_id?.substring(0, 12) + '...',
                    event.session_id?.substring(0, 12) + '...',
                    getSourceFromEvent(event),
                    event.url || '',
                    event.bot_score || 0
                ].join(','))
            ];
            
            const csvContent = csvRows.join('\n');
            const blob = new Blob(['\uFEFF' + csvContent], {
                type: 'text/csv;charset=utf-8'
            });
            
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `bot_detection_data_${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
            
            alert('ğŸ“Š ×“×•×— CSV ×”×•×¨×“ ×‘×”×¦×œ×—×”!');
        }
        
        function getSourceFromEvent(event) {
            const utmSource = new URLSearchParams(event.url ? new URL(event.url).search : '').get('utm_source');
            if (utmSource) return utmSource;
            
            if (event.referrer && event.referrer !== '') {
                try {
                    return new URL(event.referrer).hostname;
                } catch (e) {
                    return '×¨×¤×¨×¨ ×œ× ×™×“×•×¢';
                }
            }
            return '×’×™×©×” ×™×©×™×¨×”';
        }
        
        function clearAllData() {
            if (confirm('âš ï¸ ×”×× ××ª×” ×‘×˜×•×— ×©×ª×¨×¦×” ×œ××—×•×§ ××ª ×›×œ ×”× ×ª×•× ×™×?')) {
                localStorage.removeItem('custom_analytics');
                localStorage.removeItem('visitor_id');
                
                analyticsData = [];
                sourceTracking = {};
                sessionTimeline = [];
                realTimeStats = {
                    totalVisitors: 1,
                    botDetections: 0,
                    suspiciousActivities: 0,
                    buttonClicks: 0,
                    mouseMovements: 0,
                    pageInteractions: 0
                };
                
                updateRealTimeStatsDisplay();
                updateSourceDisplay();
                updateTimelineDisplay();
                
                alert('ğŸ—‘ï¸ ×›×œ ×”× ×ª×•× ×™× × ××—×§×• ×‘×”×¦×œ×—×”!');
                setTimeout(() => window.location.reload(), 1000);
            }
        }
        
        function showDataSummary() {
            const data = localStorage.getItem('custom_analytics');
            const analyticsData = data ? JSON.parse(data) : [];
            
            if (analyticsData.length === 0) {
                alert('ğŸ“‹ ××™×Ÿ × ×ª×•× ×™× ×œ×¡×™×›×•×');
                return;
            }
            
            const botEvents = analyticsData.filter(e => e.type === 'bot_detection' && e.bot_score !== undefined);
            const sources = {};
            
            analyticsData.forEach(event => {
                const source = getSourceFromEvent(event);
                sources[source] = (sources[source] || 0) + 1;
            });
            
            let summary = 'ğŸ“‹ ×¡×™×›×•× × ×ª×•× ×™×:\nâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•\n\n';
            summary += `ğŸ“Š ×¡×š ×”×›×œ ××™×¨×•×¢×™×: ${analyticsData.length}\n`;
            summary += `ğŸ‘¥ ××‘×§×¨×™× ×™×™×—×•×“×™×™×: ${[...new Set(analyticsData.map(e => e.visitor_id))].length}\n`;
            summary += `ğŸ”— ×¡×©× ×™× ×™×™×—×•×“×™×™×: ${[...new Set(analyticsData.map(e => e.session_id))].length}\n\n`;
            
            if (botEvents.length > 0) {
                const avgBotScore = Math.round(botEvents.reduce((sum, e) => sum + e.bot_score, 0) / botEvents.length);
                summary += `ğŸ¤– × ×™×ª×•×— ×‘×•×˜×™×:\n`;
                summary += `â€¢ ×–×™×”×•×™×™× ×›×•×œ×œ×™×: ${botEvents.length}\n`;
                summary += `â€¢ ×¦×™×•×Ÿ ×××•×¦×¢: ${avgBotScore}\n\n`;
            }
            
            summary += 'ğŸŒ ××§×•×¨×•×ª ××•×‘×™×œ×™×:\n';
            Object.entries(sources)
                .sort((a, b) => b[1] - a[1])
                .slice(0, 5)
                .forEach(([source, count]) => {
                    summary += `â€¢ ${source}: ${count}\n`;
                });
            
            alert(summary);
        }

        // ×§×‘×œ×ª ××§×•×¨ ×××™×¨×•×¢
        function getSourceFromEvent(event) {
            if (event.utm_params && event.utm_params.utm_source) {
                return event.utm_params.utm_source;
            }
            if (event.url) {
                const url = new URL(event.url);
                const utmSource = url.searchParams.get('utm_source');
                if (utmSource) return utmSource;
            }
            if (event.referrer && event.referrer !== '') {
                try {
                    return new URL(event.referrer).hostname;
                } catch (e) {
                    return '×¨×¤×¨×¨ ×œ× ×™×“×•×¢';
                }
            }
            return '×’×™×©×” ×™×©×™×¨×”';
        }

        // ×§×‘×œ×ª UTM ×××™×¨×•×¢
        function getUTMFromEvent(event) {
            if (event.utm_params && event.utm_params.utm_campaign) {
                return event.utm_params.utm_campaign;
            }
            if (event.url) {
                const url = new URL(event.url);
                const utmCampaign = url.searchParams.get('utm_campaign');
                if (utmCampaign) return utmCampaign;
            }
            return '×œ×œ× UTM';
        }

        // ×¡×™×›×•× UTM
        function getUTMSummary() {
            const data = localStorage.getItem('custom_analytics');
            const analyticsData = data ? JSON.parse(data) : [];
            const campaigns = {};
            
            analyticsData.forEach(event => {
                const campaign = getUTMFromEvent(event);
                if (campaign && campaign !== '×œ×œ× UTM') {
                    if (!campaigns[campaign]) {
                        campaigns[campaign] = { visits: 0, bots: 0 };
                    }
                    campaigns[campaign].visits++;
                    if (event.bot_score > 50) {
                        campaigns[campaign].bots++;
                    }
                }
            });
            
            return campaigns;
        }

        // × ×™×ª×•×— ×‘×•×˜×™×
        function getBotAnalysis() {
            const data = localStorage.getItem('custom_analytics');
            const analyticsData = data ? JSON.parse(data) : [];
            
            const botEvents = analyticsData.filter(e => 
                e.type === 'bot_detection' && e.bot_score !== undefined
            );
            
            const analysis = {
                total_detections: botEvents.length,
                confirmed_bots: botEvents.filter(e => e.bot_score >= 70).length,
                suspicious: botEvents.filter(e => e.bot_score >= 40 && e.bot_score < 70).length,
                likely_humans: botEvents.filter(e => e.bot_score < 40).length,
                avg_bot_score: botEvents.length > 0 
                    ? Math.round(botEvents.reduce((sum, e) => sum + e.bot_score, 0) / botEvents.length)
                    : 0
            };
            
            return analysis;
        }

        // ×”×¤×¢×œ×” ××•×˜×•××˜×™×ª
        window.onload = async () => {
            // × ×™×ª×•×— ××§×•×¨ ×”×’×¢×”
            analyzeReferrer();
            
            // ×§×¨×™××ª ×¤×¨××˜×¨×™ UTM
            parseUTMParams();
            
            // ×”×¤×¢×œ×ª ×–×™×”×•×™ ××ª×§×“×
            detectAdvancedBot();
            
            // ×”×¤×¢×œ×ª ××¢×§×‘ ×”×ª× ×”×’×•×ª
            initBehaviorTracking();
            
            // ×©×œ×™×—×ª ××™×¨×•×¢ ×¢××•×“ × ×˜×¢×Ÿ ×œ××¢×¨×›×ª ×©×œ× ×•
            logAnalyticsEvent('page_view', {
                'page_title': document.title,
                'user_agent': navigator.userAgent,
                'screen_resolution': screen.width + 'x' + screen.height,
                'device_fingerprint': deviceFingerprint,
                'referrer': document.referrer,
                'utm_params': parseUTMParams()
            });
            
            // ×¢×“×›×•×Ÿ ×¡×˜×˜×™×¡×˜×™×§×•×ª ×¨××©×•× ×™
            updateRealTimeStatsDisplay();
            
            // ×”×•×¡×¤×” ×¨××©×•× ×™×ª ×œ×¦×™×¨ ×”×–××Ÿ
            addToTimeline('page_view', {page_title: document.title});
            
            console.log('ğŸš€ ××¢×¨×›×ª ×–×™×”×•×™ ×‘×•×˜×™× ××ª×§×“××ª ×”×•×¤×¢×œ×” ×‘×”×¦×œ×—×”!');
        };
    </script>
</body>
</html>
